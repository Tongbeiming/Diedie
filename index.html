<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>给蝶蝶宝宝的碎碎念</title>
    <style>
        body {
            margin: 0;
            height: 100vh;
            background: url('./bg.png') center/cover;
            overflow: hidden;
            position: relative;
        }

        .letter-container {
            position: absolute;
            bottom: -100%;
            width: 100%;
            height: 100vh;
            overflow-y: auto;
            animation: riseUp 8s ease-out forwards;
            display: none; /* 初始隐藏 */
        }

        .letter-content {
            width: 800px; /* 调整宽度 */
            margin: 100px auto;
            padding: 60px; /* 调整内边距 */
            background: rgba(255, 245, 230, 0.9);
            border-radius: 15px; /* 调整圆角 */
            box-shadow: 0 0 30px rgb(232, 229, 229); /* 调整阴影 */
            line-height: 1.8;
            font-family: '楷体', cursive;
            font-size: 24px; /* 调整字体大小 */
        }

        .audio-permission {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 245, 230, 0.9);
            padding: 40px 80px; /* 调整内边距 */
            border-radius: 15px; /* 调整圆角 */
            box-shadow: 0 0 30px rgba(0,0,0,0.1); /* 调整阴影 */
            text-align: center;
            z-index: 1000;
            cursor: pointer;
            font-size: 24px; /* 调整字体大小 */
        }

        #fireworks {
            position: fixed;
            top: 0;
            left: 0;
            pointer-events: none;
            mix-blend-mode: screen; /* 添加混合模式使烟花更自然 */
            display: none; /* 初始隐藏 */
        }

        @keyframes riseUp {
            0% {
                bottom: -100%;
                opacity: 0;
            }
            100% {
                bottom: 0;
                opacity: 1;
            }
        }
    </style>
</head>
<body>
    <!-- 背景音乐 -->
    <div class="audio-permission" id="audioPrompt">
        <p>🌸 轻触此处开启诗意时光</p>
    </div>

    <audio id="bgMusic" loop>
        <source src="./mhsw.mp3" type="audio/mpeg">
        您的浏览器不支持音频播放
    </audio>

    <!-- 信件内容 -->
    <div class="letter-container" id="letterContainer">
        <div class="letter-content">
            <h2 style="text-align: center;">雪吻云笺</h2>
            <!-- 这里放入你的信件内容 -->
            <p>亲爱的蝶蝶宝贝：</p>
            <p>新年好。刚才我站在东河堤的小道上，冬雨刚歇，枝桠间漏下的天光像碎银铺满石板路。前些年总觉青春已去，每常独自走这条小径，树影斑驳依旧，却总觉得少了半片脚步声。可能是盛夏的热烈吧？前日整理旧书箱，翻出当年厚厚的语文笔记，墨迹似已褪成烟灰色。扉页夹着的树叶的标本突然滑落，叶脉间还凝着秋阳的余温。忽然记起你当时曾把这个叶脉书签夹进我的讲义，现在看来，文字似乎是镀上季节的金箔。每当翻动旧书，总会有干枯的花影翩然坠落，像时光抖落的鳞片。</p>
            <p>去年深秋去南京办差，秦淮河的画舫正载着红叶穿桥而过。回忆当时船舷推开的水纹里，自然而然地又浮现着你早自习磕睡着背诵《赤壁赋》的模样。河畔的乌桕树红得惊心——原来某些记忆早已长成血肉里的年轮，会在某个陌生的拐角突然抽枝。又比如暮色漫过校东侧的旧书铺时，檐角铜铃正摇碎最后一缕余晖。台子上堆叠着《花火》杂志封面，那些烫金的标题在尘埃中浮沉，像未燃尽的星子。店主勾着腰，正将一本本杂志摆上木架——牛皮纸颜色的《哲思》月刊的铅字编号，仿佛将青春文学里的隐喻裹进了火药。穿校服的少年们攥着零钱挤在柜台前，指尖掠过那些的旧书脊，又触碰那些等待升空的文字。</p>
            <p>记得高三那年总爱趴在走廊栏杆上看老树，风起时落英纷纷扬扬，不知是雪是花，总觉当时身在囚笼，但也竟是没想转瞬即逝的日子里，自以为平常的过了一天又一天，曾走神的少年变成了青年，梦里十六岁的大家的剪影仍站在栏杆前，好似连争论声都成了簌簌的花语。昨夜翻看云盘里的旧照片，有一张晚霞漫天的操场全景让我怔忡良久。镜头里没有人物，但左下角模糊的乒乓球台子上，还挂着半片被遗忘的银杏叶。原来有些画面不需要合影，单是风物的褶皱就足以收纳整段年少的呼吸。我也不知道我在想什么，或许我可以说，我想你们了吧~</p>
            <p>我昨晚买下两支名叫"银河叙事诗"的烟花。我妈妈把引信点燃的刹那，银白色光流撕裂暮色，在空中绽开层层叠叠的句读，如同被撒向夜空的诗稿。你知道吗，那年毕业后，我曾目睹过伊豆海岸三万发花火缔造的光之海，看到过悉尼歌剧院顶端数过跨年焰火的五线谱（虽然是隔空AR投影），可昨夜所有璀璨都在记忆里坍缩成十八岁的某个瞬间：当《挪威的森林》与《飞鸟集》在课桌抽屉里泛卷毛边，当泰戈尔与村上的文字在晚自习灯光下交叠，我们总以为那些被荧光笔划破的句子，是宇宙投递给青春的信标。多年后仍能在焰火绽裂的刹那，听见纸页翻动的声音——那些被火星吻过的青春，才原是最盛大的燃烧。因而实在忍不住，对你们写下了这封并无逻辑的碎碎念的新年祝福。</p>
            <p>新年钟声快要敲响时，我总会把台灯调成暖黄。这习惯从高考后保留至今，像固执地守着某个未完成的约定。此刻灯光在信纸上流淌成河，我忽而明白，那年的告别之所以不需要仪式，是因为重逢是岁月埋下的彩蛋，总在某个不经意的清晨突然闪光。愿新年将我们曾遗落的星屑窖藏成琥珀色的时光，待春风拆开冰封的信笺时，取几盏垂落的柳线作杯，看那些未寄出的絮语在杯底生根。待第一朵玉兰撞破晨雾的刹那，便启封所有被冬雪吻过的星辰，与漫天飞舞的告白慢慢对酌，碰碎整座城市的琥珀光。</p>
            <!-- 更多段落 -->
            <p style="text-align: right; margin-top: 30px;">彤彤</p>
            <p style="text-align: right;">腊月廿九夜于故乡小屋</p>
        </div>
    </div>

    <!-- 烟花画布 -->
    <canvas id="fireworks"></canvas>

    <script>
        // 新增音频交互逻辑
        const audio = document.getElementById('bgMusic');
        const audioPrompt = document.getElementById('audioPrompt');
        const letterContainer = document.getElementById('letterContainer');
        const fireworksCanvas = document.getElementById('fireworks');

        // 点击提示后开始播放
        audioPrompt.addEventListener('click', () => {
            audio.play()
                .then(() => {
                    audioPrompt.style.display = 'none';
                    letterContainer.style.display = 'block'; // 显示信件内容
                    fireworksCanvas.style.display = 'block'; // 显示烟花画布
                    animate(); // 开始烟花动画
                })
                .catch(err => {
                    console.error('音频播放失败:', err);
                    audioPrompt.innerHTML = '❌ 播放失败，请检查浏览器设置';
                });
        });

        // 尝试自动播放（部分浏览器支持）
        window.addEventListener('DOMContentLoaded', () => {
            audio.play().catch(() => {
                // 自动播放失败时显示提示
                audioPrompt.style.display = 'block';
            });
        });

        // 优化后的烟花脚本
        const canvas = document.getElementById('fireworks');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        class Particle {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.alpha = 0.9;  // 初始透明度提高
                this.baseColor = Math.random() * 360;
                this.color = `hsla(${this.baseColor}, 100%, 70%, ${this.alpha})`;
                this.velocity = {
                    x: (Math.random() - 0.5) * 5,
                    y: (Math.random() - 0.5) * 5
                };
                this.size = Math.random() * 3 + 1;
                this.decay = 0.015; // 增加消失速度
            }

            draw() {
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }

            update() {
                this.x += this.velocity.x;
                this.y += this.velocity.y;
                this.alpha -= this.decay;  // 使用动态消失速度
                this.color = `hsla(${this.baseColor}, 80%, 70%, ${this.alpha})`;
                this.size *= 0.98;  // 添加粒子收缩效果
                this.draw();
            }
        }

        let particles = [];
        function createFirework() {
            const x = Math.random() * canvas.width * 0.8 + canvas.width * 0.1;
            const y = Math.random() * canvas.height * 0.6 + canvas.height * 0.2;
            for (let i = 0; i < 30; i++) {  // 进一步减少粒子数量
				particles.push(new Particle(x, y));
			}
		}
	
		function animate() {
			// 使用更淡的背景清除方式
			ctx.fillStyle = 'rgba(0, 0, 0, 0.08)';
			ctx.fillRect(0, 0, canvas.width, canvas.height);
			
			// 从后往前遍历避免索引问题
			for (let i = particles.length - 1; i >= 0; i--) {
				particles[i].update();
				if (particles[i].alpha <= 0 || particles[i].size <= 0.5) {
					particles.splice(i, 1);
				}
			}
			
			// 添加时间间隔控制
			if (Math.random() < 0.015) createFirework(); // 进一步降低生成频率
			requestAnimationFrame(animate);
		}
	
		animate();
	
		// 窗口大小改变时重置画布
		window.addEventListener('resize', () => {
			canvas.width = window.innerWidth;
			canvas.height = window.innerHeight;
		});
	</script>
</body>
</html>
